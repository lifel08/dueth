<%= content_for :head do %>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css' rel='stylesheet'/>
<% end %>

<%= content_for :footer_script do %>
  <script type="text/javascript">
      mapboxgl.accessToken = 'pk.eyJ1IjoibGlmZWwwOCIsImEiOiJja252cDQ1Mmkwb3h4Mm9vYWY3Z3YycDdoIn0.3Jn2hjSix6AUKv4zPqAUgw';

      console.log(mapboxgl);

      var center = <%= j @center%>;

      console.log(center);

      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/light-v10',
          center: center,
          zoom: 12
      });

    <%  @instruments.each do |instrument| %>
       var markerNow = <%= j instrument.center %>;
       var marker = new mapboxgl.Marker({
           color: "#FFFFFF",
           draggable: true
      }).setLngLat(markerNow)
          .addTo(map);
    <% end %>

      // add markers to map
  </script>
<% end  %>

<section>
  <h1> <%= params[:title] %> rental <%= params[:location] %></h1>
    <div class="content">
      <div class="cards">
        <% @instruments.each do |instrument| %>
          <%= render "./components/instrument_card_big", instrument: instrument %>
        <% end %>
      </div>
      <div id='map' >
      </div>
    </div>
</section>
